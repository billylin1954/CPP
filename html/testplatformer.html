
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>platform</title>
    <style>
        #backroundImg {
            top: 0;
            left: 0;
            right: 0;
        }
    </style>
</head>

<body>
    <canvas id="board" width=1000 height="1000"></canvas>
    <script>
        //variables
        console.log(outerWidth)
        let goomba = {
            X: 1000,
            Y: 630,
            width: 60,
            height: 80,
            Yspeed: 2
        }
        let coin = {
            X: 1250,
            Y: 300,
            width: 60,
            height: 70,
            //Yspeed:2
        }
        var checkpoint = 1
        let levels = [
    [], // Level 0 (empty)
    [450 + window.outerWidth, 400, 500 , 600, 800 + window.outerWidth, 800, 50], // Level 3
    [450, 400, 500, 600, 800, 800, 300, 50] // Level 1
    // Add more levels as needed
];

        var currentLevel = levels[1]; // Set the current level here
        // var levelnum=[levels.level2]
        var floor = 730;
        var platformY = 0;
        var platformX = 0;
        var platformwidth = 0;
        var platformheight = 0;
        // levelnum=[levels.level2];
        levelnum = [levels[1]];
        let platform = [450, 430, 300, 50, 1200, 400, 300, 50];
        let platform2 = currentLevel; // Set the current level here
        //each level ten arrays in levelnum
        let x = 300;
        let xvelocity = 0;
        let y = 90;
        let Yvelocity;
        let gravityspeed = 0;
        let gravity = 0.4;
        const c = document.getElementById("board");
        const ctx = c.getContext("2d");
        ctx.canvas.width = window.outerWidth;
        ctx.canvas.height = window.outerHeight;

        //update function
        function update() {
            ctx.clearRect(0, 0, window.outerWidth, window.outerHeight);
            backroundImg = new Image();
            backroundImg.src = "platfrom_backround.png";
            ctx.drawImage(backroundImg, 0, 0, 3200, 1700);
            ctx.fillStyle = "#FF033E"
            ctx.fillRect(0, floor + 80, window.outerWidth, 300);
            // console.log(x);
            // console.log(y);
            ctx.fillStyle = "red"
            for (var i = 0; i < platform.length; i += 4) {
                platformX = platform[i];
                platformY = platform[i + 1];
                platformwidth = platform[i + 2];
                platformheight = platform[i + 3];
                ctx.fillRect(platformX, platformY, platformwidth, platformheight);
            }
            ctx.fillStyle = "orange"
            for (var j = 0; j < platform2.length; j += 4) {
                platformX = platform2[j];
                platformY = platform2[j + 1];
                platformwidth = platform2[j + 2];
                platformheight = platform2[j + 3];
                ctx.fillRect(platformX, platformY, platformwidth, platformheight);
            }
            ctx.fillStyle = "yellow"
            ctx.fillRect(coin.X, coin.Y, coin.width, coin.height);
            ctx.fillStyle = "green"
            ctx.fillRect(goomba.X, goomba.Y, goomba.width, goomba.height);

            //physics
            gravityspeed += gravity;
            goomba.Yspeed += gravity;
            y += gravityspeed;
            goomba.Y += goomba.Yspeed;
            x += xvelocity;
            goomba.X += (x - goomba.X) / 100;
            if (x >= (window.outerWidth / 2)) {
                x = (window.outerWidth / 2);
            }
            if (x < 50) {
                x = 50;

            }

            ctx.fillStyle = "blue";
            //PLAYER



            ctx.fillRect(x, y, 50, 80);



            //PLAYER

            //level
            floor = 730;
            for (var a = 0; a < platform.length; a += 4) {
                platformX = platform[a];
                platformY = platform[a + 1];
                platformwidth = platform[a + 2];
                platformheight = platform[a + 3];
                if (y > (platformY - 80) && x >= platformX && x <= (platformX + platformwidth) && y < platformY) {
                    console.log("ken");
                    gravityspeed = 0;
                    y = platformY - 80;
                    isground = y;
                    break;
                }
            }
            for (var a = 0; a < platform2.length; a += 4) {
                platformX = platform2[a];
                platformY = platform2[a + 1];
                platformwidth = platform2[a + 2];
                platformheight = platform2[a + 3];
                if (y > (platformY - 80) && x >= platformX && x <= (platformX + platformwidth) && y < platformY) {
                    console.log("ken");
                    gravityspeed = 0;
                    y = platformY - 80;
                    isground = y;
                    break;
                }
            }

            if (y > floor) {
                isground = floor;
                gravityspeed = 0;
                y = floor;
                console.log("stop");
            }
            //goomba physics
            if ((goomba.Y + goomba.height) > floor) {
                goomba.Y = floor;
                goomba.Yspeed = 0;
                console.log("stop");
            }

        }

        //inputs
        addEventListener('keydown', (event) => {
            if (event.code == "KeyW" && y == isground) {
                gravityspeed += -22;
                //console.log("working");
            }
            if (event.code == "KeyD") {
                xvelocity = 10;
                for (var i = 0; i < platform.length; i += 4) {
                    platform[i] -= 20;
                }
                for (var j = 0; j < platform2.length; j += 4) {
                    platform2[j] -= 40;
                    if ((platform2[platform2.length - 4]) == window.outerWidth) {
                        checkpoint += 1;
                        platform = levelnum[checkpoint];
                    }
                }
            }

            if (event.code == "KeyA" && x != -1100) {
                xvelocity = -10;
            }
        })

        addEventListener('keyup', (event) => {
            if (event.code == "KeyA" || event.code == "KeyD") {
                xvelocity = 0;
            }
        })
        //loop every 20 millisecond
        setInterval(update, 20);

    </script>
</body>

</html>